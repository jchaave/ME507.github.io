<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: main.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">main.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;Arduino.h&gt;</code><br />
<code>#include &lt;PrintStream.h&gt;</code><br />
<code>#include &lt;STM32FreeRTOS.h&gt;</code><br />
<code>#include &quot;<a class="el" href="taskshare_8h_source.html">taskshare.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="motorcontrol_8h_source.html">motorcontrol.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa41944b85fee040548f90f5646de7a37"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#aa41944b85fee040548f90f5646de7a37">task_process_sensor_data</a> (void *p_params)</td></tr>
<tr class="memdesc:aa41944b85fee040548f90f5646de7a37"><td class="mdescLeft">&#160;</td><td class="mdescRight">Task which processes sensor distance data and determines motor actions.  <a href="main_8cpp.html#aa41944b85fee040548f90f5646de7a37">More...</a><br /></td></tr>
<tr class="separator:aa41944b85fee040548f90f5646de7a37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ec8d10f3d242ceda9e317391e5b2f75"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#a2ec8d10f3d242ceda9e317391e5b2f75">task_sensor_scan</a> (void *p_params)</td></tr>
<tr class="memdesc:a2ec8d10f3d242ceda9e317391e5b2f75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Task which scans two proximity sensors and places readings into shares.  <a href="main_8cpp.html#a2ec8d10f3d242ceda9e317391e5b2f75">More...</a><br /></td></tr>
<tr class="separator:a2ec8d10f3d242ceda9e317391e5b2f75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d10a607affb456db666223af3796826"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#a8d10a607affb456db666223af3796826">task_RS_Motor1</a> (void *p_params)</td></tr>
<tr class="memdesc:a8d10a607affb456db666223af3796826"><td class="mdescLeft">&#160;</td><td class="mdescRight">Task which runs a motor.  <a href="main_8cpp.html#a8d10a607affb456db666223af3796826">More...</a><br /></td></tr>
<tr class="separator:a8d10a607affb456db666223af3796826"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81398860ac94a076db79a586e50f3703"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#a81398860ac94a076db79a586e50f3703">task_RS_Motor2</a> (void *p_params)</td></tr>
<tr class="memdesc:a81398860ac94a076db79a586e50f3703"><td class="mdescLeft">&#160;</td><td class="mdescRight">Task which runs a motor.  <a href="main_8cpp.html#a81398860ac94a076db79a586e50f3703">More...</a><br /></td></tr>
<tr class="separator:a81398860ac94a076db79a586e50f3703"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fc01d736fe50cf5b977f755b675f11d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#a4fc01d736fe50cf5b977f755b675f11d">setup</a> ()</td></tr>
<tr class="memdesc:a4fc01d736fe50cf5b977f755b675f11d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Arduino setup function which runs once at program startup.  <a href="main_8cpp.html#a4fc01d736fe50cf5b977f755b675f11d">More...</a><br /></td></tr>
<tr class="separator:a4fc01d736fe50cf5b977f755b675f11d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe461d27b9c48d5921c00d521181f12f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#afe461d27b9c48d5921c00d521181f12f">loop</a> ()</td></tr>
<tr class="memdesc:afe461d27b9c48d5921c00d521181f12f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Arduino's low-priority loop function, which we don't use.  <a href="main_8cpp.html#afe461d27b9c48d5921c00d521181f12f">More...</a><br /></td></tr>
<tr class="separator:afe461d27b9c48d5921c00d521181f12f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0074a6b675dee212b35cbcefca34a1ec"><td class="memItemLeft" align="right" valign="top"><a id="a0074a6b675dee212b35cbcefca34a1ec"></a>
<a class="el" href="class_share.html">Share</a>&lt; float_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>US_distance</b> (&quot;cm&quot;)</td></tr>
<tr class="separator:a0074a6b675dee212b35cbcefca34a1ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4b6328c2339032747c9c902a951f889"><td class="memItemLeft" align="right" valign="top"><a id="ae4b6328c2339032747c9c902a951f889"></a>
<a class="el" href="class_share.html">Share</a>&lt; float_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>IR_distance</b> (&quot;cm&quot;)</td></tr>
<tr class="separator:ae4b6328c2339032747c9c902a951f889"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a685576c66c5cf7a1cbd3070156ad7818"><td class="memItemLeft" align="right" valign="top"><a id="a685576c66c5cf7a1cbd3070156ad7818"></a>
<a class="el" href="class_share.html">Share</a>&lt; int32_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>M1_duty_cycle</b> (&quot;PWM&quot;)</td></tr>
<tr class="separator:a685576c66c5cf7a1cbd3070156ad7818"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1135df0db4e6d431c8ac220f3a67252"><td class="memItemLeft" align="right" valign="top"><a id="ac1135df0db4e6d431c8ac220f3a67252"></a>
<a class="el" href="class_share.html">Share</a>&lt; int32_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>M2_duty_cycle</b> (&quot;PWM&quot;)</td></tr>
<tr class="separator:ac1135df0db4e6d431c8ac220f3a67252"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2796ad8f307b7c731da67987a549823c"><td class="memItemLeft" align="right" valign="top"><a id="a2796ad8f307b7c731da67987a549823c"></a>
<a class="el" href="class_share.html">Share</a>&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>turn</b> (&quot;Turn&quot;)</td></tr>
<tr class="separator:a2796ad8f307b7c731da67987a549823c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file contains a program containing 4 tasks to run a collision avoidance car. The car takes in inputs from an ultrasonic sensor and infrared sensor to detect objects. The car is driven by two motors connected to the back two wheels of the car. This program uses the sensors, processes sensor data, and determines how to run the two motors. Task structure based on framework provided by Prof. J.R. Ridgeley IR Sensor Code Calculations based on sample code at <a href="https://github.com/sparkfun/simple_sketches/blob/master/sharp/sharp.ino">https://github.com/sparkfun/simple_sketches/blob/master/sharp/sharp.ino</a> US Sensor Code Calculations based on sample code at <a href="https://cdn-learn.adafruit.com/downloads/pdf/distance-measurement-ultrasound-hcsr04.pdf">https://cdn-learn.adafruit.com/downloads/pdf/distance-measurement-ultrasound-hcsr04.pdf</a></p>
<dl class="section author"><dt>Author</dt><dd>Peyton Ulrich, Jose Chavez, Matt Tagupa</dd></dl>
<dl class="section date"><dt>Date</dt><dd>10 Nov 2020 Original file </dd>
<dd>
01 Dec 2020 Updated file </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="afe461d27b9c48d5921c00d521181f12f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe461d27b9c48d5921c00d521181f12f">&#9670;&nbsp;</a></span>loop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void loop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Arduino's low-priority loop function, which we don't use. </p>
<p>A non-RTOS Arduino program runs all of its continuously running code in this function after <code><a class="el" href="main_8cpp.html#a4fc01d736fe50cf5b977f755b675f11d" title="Arduino setup function which runs once at program startup.">setup()</a></code> has finished. When using FreeRTOS, <code><a class="el" href="main_8cpp.html#afe461d27b9c48d5921c00d521181f12f" title="Arduino&#39;s low-priority loop function, which we don&#39;t use.">loop()</a></code> implements a low priority task on most microcontrollers, and crashes on some others, so we'll not use it. </p>

</div>
</div>
<a id="a4fc01d736fe50cf5b977f755b675f11d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fc01d736fe50cf5b977f755b675f11d">&#9670;&nbsp;</a></span>setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setup </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Arduino setup function which runs once at program startup. </p>
<p>This function sets up a serial port for communication and creates the tasks which will be run. </p>

</div>
</div>
<a id="aa41944b85fee040548f90f5646de7a37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa41944b85fee040548f90f5646de7a37">&#9670;&nbsp;</a></span>task_process_sensor_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void task_process_sensor_data </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p_params</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Task which processes sensor distance data and determines motor actions. </p>
<p>This task takes in distance readings from IR and US sensors and determines the correct action from the vehicle. It then places two PWM duty cycles to shares which will be carried to the RS_Motor1/RS_Motor2 tasks. <br  />
 </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p_params</td><td>A pointer to function parameters which we don't use. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a8d10a607affb456db666223af3796826"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d10a607affb456db666223af3796826">&#9670;&nbsp;</a></span>task_RS_Motor1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void task_RS_Motor1 </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p_params</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Task which runs a motor. </p>
<p>This task uses the PWM duty cycle given to it and decides how to run the motor </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p_params</td><td>A pointer to function parameters which we don't use. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a81398860ac94a076db79a586e50f3703"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81398860ac94a076db79a586e50f3703">&#9670;&nbsp;</a></span>task_RS_Motor2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void task_RS_Motor2 </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p_params</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Task which runs a motor. </p>
<p>This task uses the PWM duty cycle given to it and decides how to run the motor </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p_params</td><td>A pointer to function parameters which we don't use. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a2ec8d10f3d242ceda9e317391e5b2f75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ec8d10f3d242ceda9e317391e5b2f75">&#9670;&nbsp;</a></span>task_sensor_scan()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void task_sensor_scan </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p_params</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Task which scans two proximity sensors and places readings into shares. </p>
<p>This task runs an ultrasonic sensor and an infrared sensor to collect proximity readings. Code to use these sensors is borrowed from example code found online and cited within comments. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p_params</td><td>A pointer to function parameters which we don't use. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
